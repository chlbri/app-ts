{"version":3,"file":"flatMap.cjs","sources":["../../../src/states/functions/flatMap.ts"],"sourcesContent":["import { DEFAULT_DELIMITER } from '#constants';\nimport type { FlatMapN, NodeConfig } from '../types';\n\nexport type FlatMap_F<T extends NodeConfig = NodeConfig> = <\n  const SN extends T,\n  Wc extends boolean = true,\n>(\n  config: SN,\n  withChildren?: Wc,\n  delimiter?: string,\n  path?: string,\n) => FlatMapN<SN, Wc>;\n\n/**\n * Flattens a state node configuration into a map structure.\n *\n * @param node - The state node configuration to flatten.\n * @param withChildren - Whether to include child states in the output.\n * @param delimiter - The delimiter to use for paths in the output map. Defaults to {@linkcode DEFAULT_DELIMITER}.\n * @param path - The current path in the output map (used for recursion).\n * @returns A flat map of the state node configuration.\n *\n * @see {@linkcode FlatMap_F} for more details.\n */\nexport const flatMap: FlatMap_F = (\n  node,\n  withChildren,\n  delimiter = DEFAULT_DELIMITER,\n  path = '',\n) => {\n  //TODO: use it to perform flat in @bemedev/decompose\n  //TODO: Export flat in @bemedev/decompose\n  const { states, ...rest } = node;\n\n  const check = withChildren === undefined || withChildren === true;\n\n  let out: any = {};\n  out[path === '' ? DEFAULT_DELIMITER : path] = check ? node : rest;\n\n  if (states) {\n    for (const key in states) {\n      if (Object.prototype.hasOwnProperty.call(states, key)) {\n        const element = states[key];\n        const inner = flatMap(\n          element,\n          withChildren,\n          delimiter,\n          `${path}${DEFAULT_DELIMITER}${key}`,\n        );\n        out = { ...out, ...inner };\n      }\n    }\n  }\n\n  return out;\n};\n"],"names":["DEFAULT_DELIMITER"],"mappings":";;;;;AAaA;;;;;;;;;;AAUG;AACI,MAAM,OAAO,GAAc,CAChC,IAAI,EACJ,YAAY,EACZ,SAAS,GAAGA,mCAAiB,EAC7B,IAAI,GAAG,EAAE,KACP;;;IAGF,MAAM,EAAE,MAAM,EAAE,GAAG,IAAI,EAAE,GAAG,IAAI;IAEhC,MAAM,KAAK,GAAG,YAAY,KAAK,SAAS,IAAI,YAAY,KAAK,IAAI;IAEjE,IAAI,GAAG,GAAQ,EAAE;IACjB,GAAG,CAAC,IAAI,KAAK,EAAE,GAAGA,mCAAiB,GAAG,IAAI,CAAC,GAAG,KAAK,GAAG,IAAI,GAAG,IAAI;IAEjE,IAAI,MAAM,EAAE;AACV,QAAA,KAAK,MAAM,GAAG,IAAI,MAAM,EAAE;AACxB,YAAA,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,EAAE;AACrD,gBAAA,MAAM,OAAO,GAAG,MAAM,CAAC,GAAG,CAAC;AAC3B,gBAAA,MAAM,KAAK,GAAG,OAAO,CACnB,OAAO,EACP,YAAY,EACZ,SAAS,EACT,CAAA,EAAG,IAAI,CAAA,EAAGA,mCAAiB,GAAG,GAAG,CAAA,CAAE,CACpC;gBACD,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,GAAG,KAAK,EAAE;YAC5B;QACF;IACF;AAEA,IAAA,OAAO,GAAG;AACZ;;;;"}